<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style_login.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
    <title>Login</title>
</head>
<body>

    <div id="welcome">
        <h1>Bem-vindo(a)! <br> <span>Suas IDEIAS estão esperando por você.</span></h1><br>
        <img src="./Innovation-amico.png" alt="" class="imagem" width="300px">
        <a href="https://storyset.com/people"  class="credito">
            People illustrations by Storyset
        </a>
    </div>

    <form id="form_cadastro">
    
        <button id="voltar_login" onclick="voltarLogin()">
            <i class="fa-regular fa-circle-left fa-spin fa-4x" style="color: #79967486;"></i>
        </button>
        <h2>Cadastre-se</h2>
        <input type="text" placeholder="Telefone, nome de usuário ou email" id="email_cadastro" required>
        <input type="password" placeholder="Senha" id="senha_cadastro" required>
        <input type="submit" value="Criar conta" id="enviar">
        <p id="mensagem"></p>
    </form>

    <form id="form_login">

        <h2>Faça Login!</h2>
        <input type="text" placeholder="Login" id="email_login">
        <input type="password" placeholder="Senha" id="senha_login"><br>
        <h3>Não tem uma conta? <span id="irParaCadastro">Cadastre-se</span></h3><br>
        <h4><a href="#" id="entrar_visitante">Entrar como visitante</a></h4>
        <input type="submit" value="Entrar" id="enviar">

    </form>

    <script>
        // Realizar cadastro
        var form_cadastro = document.getElementById("form_cadastro");
        var mensagem = document.getElementById("mensagem");

        form_cadastro.addEventListener("submit", function(event){

            event.preventDefault(); // evita recarregar a página

            var email_cadastro = document.getElementById("email_cadastro").value;
            var senha_cadastro = document.getElementById("senha_cadastro").value;

            var usuario = {
                email: email_cadastro,
                senha: senha_cadastro
            };

            // Salvar no localStorage
            var users = JSON.parse(localStorage.getItem("users")) || [];

            // Verificar se já existe usuário com mesmo email
            var existe = users.find(u => u.email === email_cadastro);
            if (existe) {
                mensagem.textContent = "Esse email já está cadastrado!";
                mensagem.style.color = "red";
                return;
            }

            // Adicionar novo usuário na lista
            users.push(usuario);

            // Salvar lista atualizada
            localStorage.setItem("users", JSON.stringify(users));

            mensagem.textContent = "Conta criada com sucesso";
            mensagem.style.color = "green";

            // Limpar formulário
            form_cadastro.reset();
        });

        // Entrar com conta existente
        var form_login = document.getElementById("form_login");

        if (form_login) {

            form_login.addEventListener("submit", function(event) {

                event.preventDefault();

                var email_login = document.getElementById("email_login").value;
                var senha_login = document.getElementById("senha_login").value;

                // Recuperar usuários salvos no localStorage
                var users = JSON.parse(localStorage.getItem("users")) || [];

                // Verificar se usuário existe
                var user = users.find(u => u.email === email_login && u.senha === senha_login);

                if (user) {
                    alert("Login realizado com sucesso!");

                    // Guardar info de usuário logado
                    localStorage.setItem("usuario_logado", JSON.stringify(user));

                    window.location.href = "index.html";
                } else {
                    alert("Usuário ou senha incorretos");
                }

            });

        }

        // Entrar como visitante
        var btnVisitante = document.getElementById("entrar_visitante");

        if (btnVisitante) {
            btnVisitante.addEventListener("click", function(event) {
                event.preventDefault();

                // Cria um "usuário" especial de visitante
                var visitante = {
                    email: "visitante",
                    senha: null
                };

                localStorage.setItem("usuario_logado", JSON.stringify(visitante));

                window.location.href = "index.html";
            });
        }

        // Abrir form de cadastro
        var link_cadastro = document.getElementById("irParaCadastro");

        link_cadastro.addEventListener("click", function() {

            document.getElementById("form_cadastro").style.display="flex";
            document.getElementById("form_login").style.display="none";

        });

        function voltarLogin(){
            window.location.href = "login.html"
        }

        



    </script>

</body>
</html>